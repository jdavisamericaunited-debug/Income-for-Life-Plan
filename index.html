<!-- AmericaPlanning â€“ No-Plan Joint Income Page -->
<div id="ap-no-plan-joint" style="max-width:1200px;margin:0 auto;padding:16px;box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;">
  <style>
    #ap-no-plan-joint * {
      box-sizing: border-box;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    }
    #ap-no-plan-joint h2{
      margin:0 0 8px;
      font-size:24px;
      color:#0b5aa2;
      font-weight:700;
    }
    #ap-no-plan-joint p.ap-intro{
      margin:0 0 10px;
      font-size:14px;
      line-height:1.5;
      color:#333;
    }
    #ap-no-plan-joint .ap-note{
      font-size:12px;
      color:#555;
      margin-bottom:14px;
    }
    #ap-no-plan-joint .ap-table-wrapper{
      overflow-x:auto;
      border-radius:8px;
      background:#f9fafb;
      padding:8px;
      border:1px solid #e5e7eb;
    }
    #ap-no-plan-joint table.ap-income-table{
      width:100%;
      border-collapse:collapse;
      min-width:900px;
      background:#fff;
    }
    #ap-no-plan-joint table.ap-income-table thead th{
      background:#0b5aa2;
      color:#f9fafb;
      padding:6px 4px;
      font-size:13px;
      text-align:center;
      border:1px solid #d1d5db;
      white-space:nowrap;
    }
    #ap-no-plan-joint table.ap-income-table tbody td{
      border:1px solid #e5e7eb;
      padding:4px;
      text-align:center;
      font-size:13px;
    }
    /* His SS (4th col) light blue */
    #ap-no-plan-joint table.ap-income-table thead th:nth-child(4),
    #ap-no-plan-joint table.ap-income-table tbody td:nth-child(4){
      background:#e0f2ff;
    }
    /* Her SS (5th col) light pink */
    #ap-no-plan-joint table.ap-income-table thead th:nth-child(5),
    #ap-no-plan-joint table.ap-income-table tbody td:nth-child(5){
      background:#ffe0ef;
    }
    #ap-no-plan-joint input.ap-cell-input{
      width:100%;
      padding:2px 3px;
      font-size:12px;
      border:1px solid #d1d5db;
      border-radius:4px;
      text-align:right;
    }
    #ap-no-plan-joint input.ap-cell-input:focus{
      outline:2px solid #0b5aa2;
      outline-offset:0;
    }
    #ap-no-plan-joint input.ap-year-input,
    #ap-no-plan-joint input.ap-age-input{
      text-align:center;
    }
    #ap-no-plan-joint .ap-gap-negative{
      color:red !important;
      font-weight:700 !important;
    }
    #ap-no-plan-joint .ap-gap-nonnegative{
      color:inherit;
      font-weight:400;
    }
    #ap-no-plan-joint .ap-footer-note{
      margin-top:8px;
      font-size:12px;
      color:#555;
      font-style:italic;
    }
  </style>

  <h2>No-Plan Joint Income Projection</h2>
  <p class="ap-intro">
    Joint income if both spouses are living. Enter yearly amounts for His Social Security, Her Social Security,
    pension income, other income, and your Target Income.
  </p>
  <p class="ap-note">
    <strong>Auto-Save:</strong> Everything you type on this page is saved in this browser. When you return on the same
    computer + browser, your entries reload automatically.
  </p>

  <div class="ap-table-wrapper">
    <table class="ap-income-table" id="ap-table-joint">
      <thead>
        <tr>
          <th>Year</th>
          <th>Age (His)</th>
          <th>Age (Her)</th>
          <th>His Social Security</th>
          <th>Her Social Security</th>
          <th>Pension Income</th>
          <th>Other Income</th>
          <th>Total Income</th>
          <th>Target Income</th>
          <th>Gap</th>
        </tr>
      </thead>
      <tbody id="ap-body-joint">
        <!-- rows created by script -->
      </tbody>
    </table>
  </div>

  <div class="ap-footer-note">
    Any negative Gap is shown in <span style="color:red;font-weight:700;">bold red</span>.
  </div>
</div>

<script>
(function(){
  var ROW_COUNT = 30;
  var STORAGE_KEY = "IFL_NO_PLAN_JOINT_" + location.pathname;

  function parseNum(v){
    if(v==null) return 0;
    var t = String(v).replace(/[,$\s]/g,"");
    if(t==="") return 0;
    var n = parseFloat(t);
    return isNaN(n)?0:n;
  }
  function formatMoney(v){
    if(isNaN(v)) return "";
    var r = Math.round(v);
    return r.toLocaleString("en-US");
  }

  function createCell(row,id,extra){
    var td=document.createElement("td");
    var inp=document.createElement("input");
    inp.type="text";
    inp.id=id;
    inp.name=id;
    inp.className="ap-cell-input "+(extra||"");
    td.appendChild(inp);
    row.appendChild(td);
  }

  function buildRows(){
    var body=document.getElementById("ap-body-joint");
    if(!body) return;
    body.innerHTML="";
    for(var i=0;i<ROW_COUNT;i++){
      var r=document.createElement("tr");
      createCell(r,"joint_year_"+i,"ap-year-input");
      createCell(r,"joint_age_his_"+i,"ap-age-input");
      createCell(r,"joint_age_her_"+i,"ap-age-input");
      createCell(r,"joint_his_ss_"+i,"ap-his-ss");
      createCell(r,"joint_her_ss_"+i,"ap-her-ss");
      createCell(r,"joint_pension_"+i,"ap-pension");
      createCell(r,"joint_other_"+i,"ap-other");

      var tdTot=document.createElement("td");
      var tot=document.createElement("input");
      tot.type="text";
      tot.id="joint_total_"+i;
      tot.name="joint_total_"+i;
      tot.className="ap-cell-input ap-total";
      tot.readOnly=true;
      tdTot.appendChild(tot);
      r.appendChild(tdTot);

      createCell(r,"joint_target_"+i,"ap-target");

      var tdGap=document.createElement("td");
      var gap=document.createElement("input");
      gap.type="text";
      gap.id="joint_gap_"+i;
      gap.name="joint_gap_"+i;
      gap.className="ap-cell-input ap-gap";
      gap.readOnly=true;
      tdGap.appendChild(gap);
      r.appendChild(tdGap);

      body.appendChild(r);
    }
  }

  function getFields(){
    return Array.from(document.querySelectorAll("#ap-no-plan-joint input.ap-cell-input"));
  }

  function save(){
    try{
      var f=getFields(), data={};
      f.forEach(function(el){
        var k=el.id||el.name;
        if(!k) return;
        data[k]={v:el.value};
      });
      localStorage.setItem(STORAGE_KEY,JSON.stringify(data));
    }catch(e){ console && console.warn && console.warn(e); }
  }

  function load(){
    try{
      var raw=localStorage.getItem(STORAGE_KEY);
      if(!raw) return;
      var data=JSON.parse(raw);
      var f=getFields();
      f.forEach(function(el){
        var k=el.id||el.name;
        if(!k||!(k in data)) return;
        el.value=data[k].v||"";
      });
    }catch(e){ console && console.warn && console.warn(e); }
  }

  function recalc(){
    var rows=document.querySelectorAll("#ap-body-joint tr");
    rows.forEach(function(r){
      var his=r.querySelector("input[id^='joint_his_ss_']");
      var her=r.querySelector("input[id^='joint_her_ss_']");
      var pen=r.querySelector("input[id^='joint_pension_']");
      var oth=r.querySelector("input[id^='joint_other_']");
      var tot=r.querySelector("input[id^='joint_total_']");
      var tgt=r.querySelector("input[id^='joint_target_']");
      var gap=r.querySelector("input[id^='joint_gap_']");

      var h=parseNum(his&&his.value);
      var s=parseNum(her&&her.value);
      var p=parseNum(pen&&pen.value);
      var o=parseNum(oth&&oth.value);
      var total=h+s+p+o;
      if(tot) tot.value=(total===0 && tot.value==="")?"":formatMoney(total);

      var tv=parseNum(tgt&&tgt.value);
      var gv=total-tv;
      if(gap){
        gap.value=(gv===0 && gap.value==="")?"":formatMoney(gv);
        if(gv<0){
          gap.classList.add("ap-gap-negative");
          gap.classList.remove("ap-gap-nonnegative");
        }else{
          gap.classList.remove("ap-gap-negative");
          gap.classList.add("ap-gap-nonnegative");
        }
      }
    });
  }

  function onChange(){
    save();
    recalc();
  }

  document.addEventListener("DOMContentLoaded",function(){
    buildRows();
    load();
    recalc();
    var root=document.getElementById("ap-no-plan-joint");
    if(root){
      root.addEventListener("input",onChange,true);
      root.addEventListener("change",onChange,true);
    }
  });
})();
</script>
